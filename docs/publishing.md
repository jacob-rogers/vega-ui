# Публикация пакетов

Для управления версиями пакетов используется [standard-version](https://github.com/conventional-changelog/standard-version). 
Пакеты являются публичными и публикуются в [Github-реджистри](https://npm.pkg.github.com) с помощью npm.

Скоуп пакетов — [@gpn-prototypes](https://github.com/orgs/gpn-prototypes/packages).

## До публикации

Чтобы все сработало, как часы, необходимо сделать следующее:

-   Оформить коммиты по [правилам](commits-style.md)
-   [Отправить PR](pr-style.md)
-   [Пройти ревью](review.md)
-   [Пройти тестирование](qa-flow.md)

## Публикация

Опубликовать пакет можно с помощью Github Actions или вручную. При публикации происходит загрузка новых версий пакетов в Github-реджистри.

При создании PR происходит публикация альфа-версии пакета. Она происходит автоматически

### Github Actions

Запускается вручную во вкладке actions. 
[Конфигурация](../.github/workflows/publish.yml). При запуске данной конфигурации не на ветке `master` будет создана альфа-версия пакета.

Происходят следующие действия:

1.  `yarn` устанавливает зависимости
2.  `standard-version` поднимает версии пакетов и создает теги релизов
3.  `git` отправляет новые версии в репозиторий
4.  `npm` публикует новые версии в `github-registry`

## После публикации

Пакеты становятся доступны публично, привязываются к организации [gpn-prototypes](https://github.com/orgs/gpn-prototypes/packages) и репозиторию [gpn-prototypes/vega-ui](https://github.com/gpn-prototypes/vega-ui/packages).

_Внимание!_ На данный момент пакеты публикуются только в Github-реджистри, а в npm-реджистри нет. Это значит, что через `npm` нельзя их установить, не [указав откуда их нужно скачивать](package-installation.md).

## CHANGELOG

При публикации через Github Actions автоматически обновляется `CHANGELOG.md`. Сведения об изменениях берутся из PR, которые изменяли какие-либо внутренние пакеты.
